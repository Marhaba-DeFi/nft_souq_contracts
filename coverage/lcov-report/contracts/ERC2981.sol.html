<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/ERC2981.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> ERC2981.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/33</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/18</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/7</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/35</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
// OpenZeppelin Contracts (last updated v4.7.0) (token/common/ERC2981.sol)
&nbsp;
pragma solidity ^0.8.0;
&nbsp;
import "@openzeppelin/contracts/interfaces/IERC2981.sol";
import "@openzeppelin/contracts/utils/introspection/ERC165.sol";
&nbsp;
/**
 * @dev Implementation of the NFT Royalty Standard, a standardized way to retrieve royalty payment information.
 *
 * Royalty information can be specified globally for all token ids via {_setDefaultRoyalty}, and/or individually for
 * specific token ids via {_setTokenRoyalty}. The latter takes precedence over the first.
 *
 * Royalty is specified as a fraction of sale price. {_feeDenominator} is overridable but defaults to 10000, meaning the
 * fee is specified in basis points by default.
 *
 * IMPORTANT: ERC-2981 only specifies a way to signal royalty information and does not enforce its payment. See
 * https://eips.ethereum.org/EIPS/eip-2981#optional-royalty-payments[Rationale] in the EIP. Marketplaces are expected to
 * voluntarily pay royalties together with sales, but note that this standard is not yet widely supported.
 *
 * _Available since v4.5._
 */
&nbsp;
contract ERC2981 is ERC165 {
&nbsp;
    struct RoyaltyInfo {
        address[] receiver;
        uint96[] royaltyFraction;
    }
&nbsp;
    RoyaltyInfo private _defaultRoyaltyInfo;
    mapping(uint256 =&gt; RoyaltyInfo) private _tokenRoyaltyInfo;
&nbsp;
    /**
     * @dev See {IERC165-supportsInterface}.
     */
<span class="fstat-no" title="function not covered" >    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165) returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        return interfaceId == type(IERC2981).interfaceId || super.supportsInterface(interfaceId);</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function royaltyInfo(uint256 _tokenId, uint256 _salePrice) public view virtual returns (address[] memory , uint256[] memory) {</span>
<span class="cstat-no" title="statement not covered" >        RoyaltyInfo memory royalty = _tokenRoyaltyInfo[_tokenId];</span>
<span class="cstat-no" title="statement not covered" >        if (royalty.receiver.length == 0) {</span>
<span class="cstat-no" title="statement not covered" >            royalty = _defaultRoyaltyInfo</span>;
        }
<span class="cstat-no" title="statement not covered" >        uint256[] memory royaltyAmount = new uint256[](royalty.receiver.length);</span>
<span class="cstat-no" title="statement not covered" >        for(uint i=0; i &lt; royalty.receiver.length; i++){</span>
<span class="cstat-no" title="statement not covered" >            royaltyAmount[i]= ((_salePrice * royalty.royaltyFraction[i]) / _feeDenominator())</span>;
        }
<span class="cstat-no" title="statement not covered" >        return (royalty.receiver, royaltyAmount);</span>
    }
&nbsp;
    /**
     * @dev The denominator with which to interpret the fee set in {_setTokenRoyalty} and {_setDefaultRoyalty} as a
     * fraction of the sale price. Defaults to 10000 so fees are expressed in basis points, but may be customized by an
     * override.
     */
<span class="fstat-no" title="function not covered" >    function _feeDenominator() internal pure virtual returns (uint96) {</span>
<span class="cstat-no" title="statement not covered" >        return 10000;</span>
    }
&nbsp;
    /**
     * @dev Sets the royalty information that all ids in this contract will default to.
     *
     * Requirements:
     *
     * - `receiver` cannot be the zero address.
     * - `feeNumerator` cannot be greater than the fee denominator.
     */
<span class="fstat-no" title="function not covered" >    function _setDefaultRoyalty(address[] memory receiver, uint96[] memory feeNumerator) internal {</span>
        // At least one royaltyReceiver is required.
<span class="cstat-no" title="statement not covered" >        require(receiver.length &gt; 0, "No Royalty details provided")</span>;
        // Check on the maximum size over which the for loop will run over.
<span class="cstat-no" title="statement not covered" >        require(receiver.length &lt;= 5, "Too many royalty recievers details")</span>;
        //Check the length of receiver and fees should match
<span class="cstat-no" title="statement not covered" >        require(receiver.length == feeNumerator.length, "Mismatch of Royalty recievers and their fees")</span>;
<span class="cstat-no" title="statement not covered" >        uint totalFeeNumerator=0;</span>
<span class="cstat-no" title="statement not covered" >        for(uint i=0 ; i &lt; feeNumerator.length; i++){</span>
<span class="cstat-no" title="statement not covered" >            totalFeeNumerator += feeNumerator[i]</span>;
        }
<span class="cstat-no" title="statement not covered" >        require(totalFeeNumerator &lt;= _feeDenominator(), "ERC2981: royalty fee will exceed salePrice")</span>;
<span class="cstat-no" title="statement not covered" >        uint96[] memory feeFractions;</span>
<span class="cstat-no" title="statement not covered" >        address[] memory participants;</span>
<span class="cstat-no" title="statement not covered" >        participants=receiver</span>;
<span class="cstat-no" title="statement not covered" >        feeFractions = feeNumerator</span>;  
<span class="cstat-no" title="statement not covered" >        _defaultRoyaltyInfo = RoyaltyInfo(participants, feeFractions)</span>; 
    }
&nbsp;
    /**
     * @dev Removes default royalty information.
     */
<span class="fstat-no" title="function not covered" >    function _deleteDefaultRoyalty() internal virtual {</span>
        delete _defaultRoyaltyInfo;
    }
&nbsp;
    /**
     * @dev Sets the royalty information for a specific token id, overriding the global default.
     *
     * Requirements:
     *
     * - `receiver` cannot be the zero address.
     * - `feeNumerator` cannot be greater than the fee denominator.
     */
<span class="fstat-no" title="function not covered" >    function _setTokenRoyalty(</span>
        uint256 tokenId,
        address[] memory receiver,
        uint96[] memory feeNumerator
		) internal virtual {
        // At least one royaltyReceiver is required.
<span class="cstat-no" title="statement not covered" >        require(receiver.length &gt; 0, "No Royalty details provided")</span>;
        // Check on the maximum size over which the for loop will run over.
<span class="cstat-no" title="statement not covered" >        require(receiver.length &lt;= 5, "Too many royalty recievers details")</span>;
        //Check the length of receiver and fees should match
<span class="cstat-no" title="statement not covered" >        require(receiver.length == feeNumerator.length, "Mismatch of Royalty recievers and their fees")</span>;
<span class="cstat-no" title="statement not covered" >        uint totalFeeNumerator=0;</span>
<span class="cstat-no" title="statement not covered" >        for(uint i=0 ; i &lt; feeNumerator.length; i++){</span>
<span class="cstat-no" title="statement not covered" >            totalFeeNumerator += feeNumerator[i]</span>;
        }
<span class="cstat-no" title="statement not covered" >        require(totalFeeNumerator &lt;= _feeDenominator(), "ERC2981: royalty fee will exceed salePrice")</span>;
<span class="cstat-no" title="statement not covered" >        uint96[] memory feeFractions;</span>
<span class="cstat-no" title="statement not covered" >        address[] memory participants;</span>
<span class="cstat-no" title="statement not covered" >        participants=receiver</span>;
<span class="cstat-no" title="statement not covered" >        feeFractions = feeNumerator</span>;  
<span class="cstat-no" title="statement not covered" >        _tokenRoyaltyInfo[tokenId] = RoyaltyInfo(participants, feeFractions)</span>;
    }
&nbsp;
    /**
     * @dev Resets royalty information for the token id back to the global default.
     */
<span class="fstat-no" title="function not covered" >    function _resetTokenRoyalty(uint256 tokenId) internal virtual {</span>
        delete _tokenRoyaltyInfo[tokenId];
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sat Aug 27 2022 10:06:59 GMT+0300 (Arabian Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
